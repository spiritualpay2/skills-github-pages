<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streaming Web App</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 20px; }
        #search { padding: 10px; width: 300px; }
        button { padding: 10px; background-color: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        #results { margin-top: 20px; }
        .result { background: white; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; cursor: pointer; }
        .result:hover { background-color: #e9e9e9; }
        #player { margin-top: 20px; text-align: center; }
        #tv-controls { display: none; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Streaming Web App</h1>
    <input id="search" type="text" placeholder="Search movies or TV shows...">
    <button onclick="searchContent()">Search</button>
    <div id="results"></div>
    <div id="tv-controls">
        <label>Season: <input id="season" type="number" min="1" value="1"></label>
        <label>Episode: <input id="episode" type="number" min="1" value="1"></label>
        <button onclick="loadTvEmbed()">Load Episode</button>
    </div>
    <div id="player"></div>

    <script>
        const tmdbApiKey = 'YOUR_TMDB_API_KEY'; // Replace with your TMDB API key
        let currentItem = null;
        let currentImdbId = null;

        async function searchContent() {
            const query = document.getElementById('search').value;
            if (!query) return;
            const url = `https://api.themoviedb.org/3/search/multi?api_key=${tmdbApiKey}&query=${encodeURIComponent(query)}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                displayResults(data.results);
            } catch (error) {
                console.error('Error searching:', error);
            }
        }

        function displayResults(results) {
            const container = document.getElementById('results');
            container.innerHTML = '';
            results.forEach(item => {
                if (item.media_type === 'movie' || item.media_type === 'tv') {
                    const div = document.createElement('div');
                    div.className = 'result';
                    div.innerHTML = `<h3>${item.title || item.name} (${item.media_type.toUpperCase()})</h3><p>${item.overview.substring(0, 150)}...</p>`;
                    div.onclick = () => selectContent(item);
                    container.appendChild(div);
                }
            });
        }

        async function selectContent(item) {
            currentItem = item;
            const type = item.media_type;
            const id = item.id;
            const url = `https://api.themoviedb.org/3/${type}/${id}?api_key=${tmdbApiKey}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                currentImdbId = data.imdb_id;
                if (type === 'movie') {
                    document.getElementById('tv-controls').style.display = 'none';
                    loadEmbed();
                } else if (type === 'tv') {
                    document.getElementById('tv-controls').style.display = 'block';
                    loadEmbed(); // Load default s1 e1
                }
            } catch (error) {
                console.error('Error fetching details:', error);
            }
        }

        function loadTvEmbed() {
            loadEmbed();
        }

        function loadEmbed() {
            const player = document.getElementById('player');
            let embedUrl;
            if (currentItem.media_type === 'movie') {
                embedUrl = `https://player.autoembed.cc/embed/movie/${currentImdbId}`;
            } else if (currentItem.media_type === 'tv') {
                const season = document.getElementById('season').value || 1;
                const episode = document.getElementById('episode').value || 1;
                embedUrl = `https://player.autoembed.cc/embed/tv/${currentImdbId}/${season}/${episode}`;
            }
            player.innerHTML = `<iframe width="800" height="450" src="${embedUrl}" frameborder="0" allowfullscreen></iframe>`;
        }
    </script>
</body>
</html>
